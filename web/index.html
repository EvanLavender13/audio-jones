<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=no">
    <meta name="theme-color" content="#0a0a0c">
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">
    <title>AudioJones Control</title>
    <link rel="stylesheet" href="style.css">
    <script defer src="https://cdn.jsdelivr.net/npm/alpinejs@3.x.x/dist/cdn.min.js"></script>
</head>
<body>
    <div class="rack-unit">
        <!-- Header - Product Branding -->
        <header class="header">
            <div class="brand">
                <div class="brand-name">AudioJones</div>
                <div class="brand-model">Web Control Interface</div>
            </div>
            <div x-data
                 class="status"
                 :class="{'connected': $store.app.connected, 'disconnected': !$store.app.connected}"
                 x-text="$store.app.statusText"></div>
        </header>

        <!-- Audio Control Panel -->
        <section class="panel">
            <div class="panel-header">
                <span class="panel-title">Audio Input</span>
                <span class="panel-indicator"></span>
            </div>
            <div class="panel-content">
                <div class="control-row">
                    <label class="control-label" for="channel-mode">Channel Mode</label>
                    <div class="select-wrapper">
                        <select x-data
                                id="channel-mode"
                                x-model.number="$store.app.channelMode"
                                @change="$store.app.onChannelChange()"
                                :disabled="!$store.app.connected">
                            <option value="0">Left</option>
                            <option value="1">Right</option>
                            <option value="2">Max</option>
                            <option value="3">Mix</option>
                            <option value="4">Side</option>
                            <option value="5">Interleaved</option>
                        </select>
                    </div>
                </div>
            </div>
        </section>

        <!-- Analysis Meters Panel -->
        <section class="panel">
            <div class="panel-header">
                <span class="panel-title">Analysis</span>
                <span class="panel-indicator"></span>
            </div>
            <div class="panel-content" x-data>
                <template x-for="meter in ['beat', 'bass', 'mid', 'treb']" :key="meter">
                    <div class="meter-container">
                        <div class="meter-header">
                            <span class="meter-label" x-text="meter"></span>
                            <span class="meter-value" x-text="$store.app[meter].toFixed(2)"></span>
                        </div>
                        <div class="meter">
                            <div class="meter-fill"
                                 :class="'meter-' + meter"
                                 :style="{width: $store.app[meter + 'Percent'] + '%'}"></div>
                        </div>
                    </div>
                </template>
            </div>
        </section>

        <!-- Footer -->
        <footer class="footer">
            <span>AudioJones</span>
            <span class="footer-dot"></span>
            <span>v1.0</span>
        </footer>
    </div>

    <script src="app.js"></script>
</body>
</html>
