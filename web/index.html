<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="theme-color" content="#0a0a0c">
    <title>AudioJones Control</title>
    <link rel="stylesheet" href="style.css">
    <script defer src="https://cdn.jsdelivr.net/npm/alpinejs@3.x.x/dist/cdn.min.js"></script>
</head>
<body>
    <div class="app-container" x-data="{ activeSection: null }">
        <!-- Sidebar -->
        <aside class="sidebar">
            <!-- Header -->
            <header class="sidebar-header">
                <div class="brand">
                    <div class="brand-name">AudioJones</div>
                    <div class="brand-model">Web Control Interface</div>
                </div>
                <div x-data
                     class="status"
                     :class="{'connected': $store.app.connected, 'disconnected': !$store.app.connected}"
                     x-text="$store.app.statusText"></div>
            </header>

            <!-- Analysis Meters -->
            <section class="sidebar-panel">
                <div class="panel-header">
                    <span class="panel-title">Analysis</span>
                    <span class="panel-indicator"></span>
                </div>
                <div class="panel-content" x-data>
                    <template x-for="meter in ['beat', 'bass', 'mid', 'treb']" :key="meter">
                        <div class="meter-container">
                            <div class="meter-header">
                                <span class="meter-label" x-text="meter"></span>
                                <span class="meter-value" x-text="$store.app[meter].toFixed(2)"></span>
                            </div>
                            <div class="meter">
                                <div class="meter-fill"
                                     :class="'meter-' + meter"
                                     :style="{width: $store.app[meter + 'Percent'] + '%'}"></div>
                            </div>
                        </div>
                    </template>
                </div>
            </section>

            <!-- Presets -->
            <section class="sidebar-panel">
                <div class="panel-header">
                    <span class="panel-title">Presets</span>
                    <span class="panel-indicator"></span>
                </div>
                <div class="panel-content" x-data>
                    <!-- Status message -->
                    <div class="preset-status"
                         x-show="$store.app.presetStatus"
                         x-text="$store.app.presetStatus"></div>

                    <!-- Save section -->
                    <div class="control-row">
                        <label class="control-label" for="preset-name">Name</label>
                        <div class="preset-save-row">
                            <input type="text"
                                   id="preset-name"
                                   class="preset-input"
                                   x-model="$store.app.presetName"
                                   placeholder="New preset"
                                   :disabled="!$store.app.connected"
                                   @keyup.enter="$store.app.savePreset()">
                            <button class="btn-save"
                                    @click="$store.app.savePreset()"
                                    :disabled="!$store.app.connected || !$store.app.presetName.trim()">
                                Save
                            </button>
                        </div>
                    </div>

                    <!-- Preset list -->
                    <div class="preset-list">
                        <template x-for="preset in $store.app.presets" :key="preset">
                            <div class="preset-item"
                                 :class="{'selected': $store.app.selectedPreset === preset}">
                                <button class="preset-name"
                                        @click="$store.app.loadPreset(preset)"
                                        :disabled="!$store.app.connected"
                                        x-text="preset.replace('.json', '')"></button>
                                <button class="btn-delete"
                                        @click.stop="$store.app.deletePreset(preset)"
                                        :disabled="!$store.app.connected"
                                        title="Delete preset">
                                    &times;
                                </button>
                            </div>
                        </template>
                        <div class="preset-empty" x-show="$store.app.presets.length === 0">
                            No presets saved
                        </div>
                    </div>
                </div>
            </section>

            <!-- Navigation -->
            <nav class="sidebar-nav">
                <div class="nav-label">Sections</div>
                <button class="nav-item"
                        :class="{ active: activeSection === 'audio' }"
                        @click="activeSection = activeSection === 'audio' ? null : 'audio'">
                    Audio
                </button>
                <button class="nav-item"
                        :class="{ active: activeSection === 'effects' }"
                        @click="activeSection = activeSection === 'effects' ? null : 'effects'">
                    Effects
                </button>
                <button class="nav-item"
                        :class="{ active: activeSection === 'waveforms' }"
                        @click="activeSection = activeSection === 'waveforms' ? null : 'waveforms'">
                    Waveforms
                </button>
                <button class="nav-item"
                        :class="{ active: activeSection === 'spectrum' }"
                        @click="activeSection = activeSection === 'spectrum' ? null : 'spectrum'">
                    Spectrum
                </button>
            </nav>
        </aside>

        <!-- Main Area -->
        <main class="main-area">
            <!-- Empty State -->
            <div class="main-empty" x-show="activeSection === null">
                <div class="empty-icon">â—ˆ</div>
                <div class="empty-text">Select a section from the sidebar</div>
            </div>

            <!-- Audio Section -->
            <div class="section" x-show="activeSection === 'audio'" x-data>
                <div class="section-header">
                    <h2 class="section-title">Audio Input</h2>
                </div>
                <div class="section-content">
                    <div class="control-row">
                        <label class="control-label">Channel Mode</label>
                        <div class="select-wrapper">
                            <select x-model.number="$store.app.channelMode"
                                    @change="$store.app.onChannelChange()"
                                    :disabled="!$store.app.connected">
                                <option value="0">Left</option>
                                <option value="1">Right</option>
                                <option value="2">Max</option>
                                <option value="3">Mix</option>
                                <option value="4">Side</option>
                                <option value="5">Interleaved</option>
                            </select>
                        </div>
                    </div>
                </div>
            </div>

            <!-- Effects Section (Placeholder) -->
            <div class="section" x-show="activeSection === 'effects'">
                <div class="section-header">
                    <h2 class="section-title">Effects</h2>
                    <span class="section-badge">Coming Soon</span>
                </div>
                <div class="section-content section-placeholder">
                    <div class="placeholder-group">
                        <h3 class="placeholder-title">Trail / Feedback</h3>
                        <div class="control-row">
                            <label class="control-label">Trail Half-Life</label>
                            <input type="range" class="control-slider" disabled>
                            <span class="control-value">0.50s</span>
                        </div>
                        <div class="control-row">
                            <label class="control-label">Feedback Zoom</label>
                            <input type="range" class="control-slider" disabled>
                            <span class="control-value">0.98</span>
                        </div>
                        <div class="control-row">
                            <label class="control-label">Feedback Rotation</label>
                            <input type="range" class="control-slider" disabled>
                            <span class="control-value">0.005</span>
                        </div>
                    </div>
                    <div class="placeholder-group">
                        <h3 class="placeholder-title">Blur</h3>
                        <div class="control-row">
                            <label class="control-label">Base Blur Scale</label>
                            <input type="range" class="control-slider" disabled>
                            <span class="control-value">1px</span>
                        </div>
                        <div class="control-row">
                            <label class="control-label">Beat Blur Scale</label>
                            <input type="range" class="control-slider" disabled>
                            <span class="control-value">2px</span>
                        </div>
                    </div>
                </div>
            </div>

            <!-- Waveforms Section (Placeholder) -->
            <div class="section" x-show="activeSection === 'waveforms'">
                <div class="section-header">
                    <h2 class="section-title">Waveforms</h2>
                    <span class="section-badge">Coming Soon</span>
                </div>
                <div class="section-content section-placeholder">
                    <div class="waveform-tabs placeholder">
                        <button class="waveform-tab active">W1</button>
                        <button class="waveform-tab">W2</button>
                        <button class="waveform-tab">W3</button>
                        <button class="waveform-tab">W4</button>
                    </div>
                    <div class="placeholder-group">
                        <div class="control-row">
                            <label class="control-label">Amplitude Scale</label>
                            <input type="range" class="control-slider" disabled>
                            <span class="control-value">0.35</span>
                        </div>
                        <div class="control-row">
                            <label class="control-label">Line Thickness</label>
                            <input type="range" class="control-slider" disabled>
                            <span class="control-value">2px</span>
                        </div>
                        <div class="control-row">
                            <label class="control-label">Smoothness</label>
                            <input type="range" class="control-slider" disabled>
                            <span class="control-value">5.0</span>
                        </div>
                        <div class="control-row">
                            <label class="control-label">Radius</label>
                            <input type="range" class="control-slider" disabled>
                            <span class="control-value">0.25</span>
                        </div>
                    </div>
                </div>
            </div>

            <!-- Spectrum Section (Placeholder) -->
            <div class="section" x-show="activeSection === 'spectrum'">
                <div class="section-header">
                    <h2 class="section-title">Spectrum Bars</h2>
                    <span class="section-badge">Coming Soon</span>
                </div>
                <div class="section-content section-placeholder">
                    <div class="control-row">
                        <label class="control-label">Enable Spectrum</label>
                        <input type="checkbox" class="control-checkbox" disabled>
                    </div>
                    <div class="control-row">
                        <label class="control-label">Inner Radius</label>
                        <input type="range" class="control-slider" disabled>
                        <span class="control-value">0.15</span>
                    </div>
                    <div class="control-row">
                        <label class="control-label">Bar Height</label>
                        <input type="range" class="control-slider" disabled>
                        <span class="control-value">0.25</span>
                    </div>
                </div>
            </div>
        </main>
    </div>

    <script src="app.js"></script>
</body>
</html>
